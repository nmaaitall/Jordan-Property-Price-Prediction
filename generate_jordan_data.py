import pandas as pd
import numpy as np
import random

# ุชุซุจูุช ุงูู random seed ุนุดุงู ููุฏุฑ ููุฑุฑ ุงููุชุงุฆุฌ
np.random.seed(42)
random.seed(42)

# ุงูููุงุทู ุงูุฃุฑุฏููุฉ ูุน ูุชูุณุท ุณุนุฑ ุงููุชุฑ ุงูุญูููู (2024-2025)
regions = {
    'ุนุจุฏูู': 1200,
    'ุฏูุฑ ุบุจุงุฑ': 1000,
    'ุฃู ุฃุฐููุฉ': 950,
    'ุงูุตููููุฉ': 900,
    'ุฎูุฏุง': 850,
    'ุฃู ุงูุณูุงู': 820,
    'ุชูุงุน ุงูุนูู': 800,
    'ุงูุฌุงุฑุฏูุฒ': 780,
    'ุงูุดููุณุงูู': 750,
    'ุงููููุจุฏุฉ': 700,
    'ุงูุฌุจููุฉ': 650,
    'ุตูููุญ': 600,
    'ุทุจุฑุจูุฑ': 550,
    'ูุงุฑูุง': 500,
    'ุดูุง ุจุฏุฑุงู': 480,
    'ุงููุงุณููู': 470,
    'ุงูููุงุจููู': 450,
    'ุงููุงุดูู ุงูุดูุงูู': 430,
    'ุฌุจู ุงูุญุณูู': 420,
    'ุงููุตุฑ': 400,
}

# ุนุฏุฏ ุงูุนูุงุฑุงุช
n_properties = 1500

# ุชูููุฏ ุงูุจูุงูุงุช
data = {
    'ุงูููุทูุฉ': [],
    'ุงููุณุงุญุฉ_ูุชุฑ': [],
    'ุนุฏุฏ_ุงูุบุฑู': [],
    'ุนุฏุฏ_ุงูุญูุงูุงุช': [],
    'ุนูุฑ_ุงูุจูุงุก_ุณููุงุช': [],
    'ุทุงุจู': [],
    'ููุฌุฏ_ูุตุนุฏ': [],
    'ููุฌุฏ_ูููู': [],
    'ููุฌุฏ_ุญุฏููุฉ': [],
    'ููุฌุฏ_ุชุฏูุฆุฉ_ูุฑูุฒูุฉ': [],
    'ูุฑุจ_ุงูุฎุฏูุงุช': [],  # 1-10
    'ุงูุณุนุฑ_ุฏููุงุฑ': []
}

for _ in range(n_properties):
    # ุงุฎุชูุงุฑ ููุทูุฉ ุนุดูุงุฆูุฉ
    region = random.choice(list(regions.keys()))
    base_price = regions[region]

    # ุชูููุฏ ุงูููุงุตูุงุช ุจุดูู ูุงูุนู
    area = np.random.randint(80, 400)

    # ุนุฏุฏ ุงูุบุฑู ุญุณุจ ุงููุณุงุญุฉ (ุฃูุซุฑ ูุงูุนูุฉ)
    if area < 100:
        rooms = np.random.randint(1, 3)
    elif area < 150:
        rooms = np.random.randint(2, 4)
    elif area < 250:
        rooms = np.random.randint(3, 5)
    else:
        rooms = np.random.randint(4, 7)

    bathrooms = min(rooms, np.random.randint(1, 4))
    age = np.random.randint(0, 35)
    floor = np.random.randint(0, 12)

    # ูุตุนุฏ ุฃูุซุฑ ุงุญุชูุงูุงู ูู ุงูุทูุงุจู ุงูุนุงููุฉ ูุงูููุงุทู ุงูุบุงููุฉ
    has_elevator = 1 if (floor > 2 and random.random() > 0.25) or (floor > 4) else 0

    has_parking = 1 if random.random() > 0.25 else 0
    has_garden = 1 if floor <= 1 and random.random() > 0.75 else 0
    has_heating = 1 if base_price > 700 and random.random() > 0.4 else 0
    services_proximity = np.random.randint(1, 11)

    # ุญุณุงุจ ุงูุณุนุฑ ุจุทุฑููุฉ ูุงูุนูุฉ
    price = base_price * area

    # ุชุนุฏููุงุช ุงูุณุนุฑ
    price *= (1 - age * 0.012)  # ูู ุณูุฉ ุชููู 1.2%
    price *= (1 + rooms * 0.04)  # ูู ุบุฑูุฉ ุชุฒูุฏ 4%
    price *= (1 + has_elevator * 0.10)  # ูุตุนุฏ ูุฒูุฏ 10%
    price *= (1 + has_parking * 0.06)  # ูููู ูุฒูุฏ 6%
    price *= (1 + has_garden * 0.08)  # ุญุฏููุฉ ุชุฒูุฏ 8%
    price *= (1 + has_heating * 0.05)  # ุชุฏูุฆุฉ ูุฑูุฒูุฉ ุชุฒูุฏ 5%
    price *= (1 + services_proximity * 0.015)  # ูุฑุจ ุงูุฎุฏูุงุช

    # ุชุนุฏูู ุญุณุจ ุงูุทุงุจู
    if floor == 0:
        price *= 0.95  # ุงูุฃุฑุถู ุฃูู ุดูู
    elif floor >= 8:
        price *= 1.05  # ุงูุทูุงุจู ุงูุนุงููุฉ ุฃุบูู

    # ุฅุถุงูุฉ ุชุจุงูู ูุงูุนู
    price *= np.random.uniform(0.88, 1.12)

    # ุฅุถุงูุฉ ุงูุจูุงูุงุช
    data['ุงูููุทูุฉ'].append(region)
    data['ุงููุณุงุญุฉ_ูุชุฑ'].append(area)
    data['ุนุฏุฏ_ุงูุบุฑู'].append(rooms)
    data['ุนุฏุฏ_ุงูุญูุงูุงุช'].append(bathrooms)
    data['ุนูุฑ_ุงูุจูุงุก_ุณููุงุช'].append(age)
    data['ุทุงุจู'].append(floor)
    data['ููุฌุฏ_ูุตุนุฏ'].append(has_elevator)
    data['ููุฌุฏ_ูููู'].append(has_parking)
    data['ููุฌุฏ_ุญุฏููุฉ'].append(has_garden)
    data['ููุฌุฏ_ุชุฏูุฆุฉ_ูุฑูุฒูุฉ'].append(has_heating)
    data['ูุฑุจ_ุงูุฎุฏูุงุช'].append(services_proximity)
    data['ุงูุณุนุฑ_ุฏููุงุฑ'].append(int(price))

# ุฅูุดุงุก DataFrame
df = pd.DataFrame(data)

# ุญูุธ ุงูุจูุงูุงุช
df.to_csv('jordan_properties.csv', index=False, encoding='utf-8-sig')

print("โ ุชู ุฅูุดุงุก dataset ุงูุนูุงุฑุงุช ุงูุฃุฑุฏููุฉ ุจูุฌุงุญ!")
print(f"๐ ุนุฏุฏ ุงูุนูุงุฑุงุช: {len(df)}")
print(f"\n๐ ุนููุฉ ูู ุงูุจูุงูุงุช:")
print(df.head(10))
print(f"\n๐ฐ ูุทุงู ุงูุฃุณุนุงุฑ: {df['ุงูุณุนุฑ_ุฏููุงุฑ'].min():,} - {df['ุงูุณุนุฑ_ุฏููุงุฑ'].max():,} ุฏููุงุฑ")
print(f"๐ฐ ูุชูุณุท ุงูุณุนุฑ: {df['ุงูุณุนุฑ_ุฏููุงุฑ'].mean():,.0f} ุฏููุงุฑ")
print(f"\n๐๏ธ ุชูุฒูุน ุงูุนูุงุฑุงุช ุญุณุจ ุงูููุทูุฉ:")
print(df['ุงูููุทูุฉ'].value_counts())